<html><head><title>zziplib - zip file access </title>
 <meta name="formatter" content="mksite.pl" />
 <meta name="src-dir" content="." />
 <meta name="DC.date.issued" content="1. June 2000" />
 <meta name="DC.title" content="ZIP File Access" />
 <meta name="DC.relation.isFormatOf" content="zzip-file.htm" />
 <meta name="DC.date.modified" content="2014-12-25" />
 <meta name="DC.date" content="1. June 2000" />
 <meta name="DC.relation.section" content="zzip-index.html" />
 <meta name="DC.title.selected" content="Transparently" />
 <meta name="DC.publisher" content="mo" />
 <style type="text/css"><!--
  /* sdocbook.css */
  
  .date
  {
    display: inline;
  }
 --></style>

  <style>
   a:link          { text-decoration : none ; color : #000080 ; }
   a:visited       { text-decoration : none ; color : #200060 ; }
   .justify        { text-align : justify ; }
   .navlist        { background-color : #F0F0F0 ; 
                     width : 9em ; speak : none ; }
   .navprint       { pause-after : 200ms ; speak : spell-out ; }
   body            { background-color : white ; }
   .P              { text-align : justify ; margin-right: 1em ;
                                            margin-left: 1em ; }
   .BLOCKQUOTE     { text-align : justify ; margin-right: 3em ;
                                            margin-left: 3em ; }
   .PRE            {                       margin-right: 2em ;
                                            margin-left: 2em ; }
   .DT             { font-weight : bold ; }
   .DD             { text-align : justify ; margin-right: 1em ; }
  </style>
</head><body>
<!--mksite:sectioninfo--> <!--mksite:nosimplevars-->
<table width="100%"><tr valign="top"><td class="navlist">
<center><sub>
  <!--mksite:printerfriendly--> 
  <a href="zzip-file.print.html" title="printer friendly version">
  <img alt="printer / text mode version" width="8" height="8" border="0" /></a>
  </sub> &nbsp;
     <big><big><big><b>
     <font color="#800080"><sup>Z</sup>ZIP<sub>lib</sub></font>
     </b></big></big></big>
<br><big><b> 0.13.62 </b></big>
</center>
<hr><a href="zzip-index.html">Library</a>
<br>-<a href="zzip-zip.html"> ZIP Access</a>
<br>-<b><a href="zzip-file.html"> Transparently</a></b>
<br>-<a href="zzip-sdl-rwops.html"> SDLrwops <small>Example</small></a>
<br>-<a href="zzip-extio.html"> ext/io <small>Customization</small></a>
<br>&nbsp;<a href="zzip-xor.html"> xor/io <small>Obfuscation</small></a>
<br>&nbsp;<a href="zzip-crypt.html"> zip/no <small>Encryption</small></a>
<small><a href="zzip-cryptoid.html">(2)</a></small>
<br>-<a href="zzip-api.html"> Library API</a>
<br>&nbsp;<a href="zzip-basics.html"> basics</a></u>
&nbsp;<a href="zzip-extras.html"> extras</a></u>
<br>=<a href="zzip-parse.html">Parsing ZIPs</a>
<br>-<a href="64on32.html"> 64on32 extras</a>
<br>-<a href="future.html"> Next To Come</a> <br> &nbsp;
<small><a href="fseeko.html"> fseeko </a></small>
<small><a href="mmapped.html"> mmapped </a></small>
<small><a href="memdisk.html"> memdisk </a></small>
<br>-<a href="configs.html"> Config Helpers</a>
<br>-<a href="sfx-make.html"> Making a zip/exe</a>
<br>=<a href="history.html">Hints And Links</a>
<br>-<a href="referentials.html"> Referentials</a>
<br>-<a href="functions.html"> Functions List..</a>
<br> &nbsp; -<a href="zziplib.html"> zziplib.*</a>
<br> &nbsp; -<a href="zzipmmapped.html"> zzipmmapped.*</a>
<br> &nbsp; -<a href="zzipfseeko.html"> zzipfseeko.*</a>
<!--START-->
<br> &nbsp; -<a href="man/index.html"><small> unix man pages</small></a>
<!--ENDS-->

<br>&nbsp
<br>&nbsp;
<br><small><a href="faq.html"> faq </a></small>
<small>&nbsp;<a href="notes.html"> notes </a></small>
<small>&nbsp;<a href="zip-php.html"> zip-php </a></small>
<hr><a href="download.html"> Download Area </a>
<br>&nbsp;<a href="developer.html"> Developer Area </a>
<br>&nbsp;<a href="http://sourceforge.net/projects/zziplib"> Sourceforge Project</a>
<br>&nbsp;<a href="http://zziplib.sourceforge.net"> zziplib.sf.net 
                                  <small><i>Home</i></small></a>

<br>&nbsp;<a href="changes.html"> ChangeLog</a>
<br><small><a href="copying.html"> LGPL/MPL license</a></small>
<br>&nbsp;
<hr>
<center><!--START-->
     <a href="http://sourceforge.net/project/?group_id=6389">
        <img src="http://sourceforge.net/sflogo.php?group_id=6389&type=2"
            border="0" alt="sourceforge.net" width="125" height="37">
     </a>
<br><small><a href="site.html">-sitemap-</a></small>
</center><!--ENDS-->

<p align="right"><small>
generated 2014-12-26
</small>
<br> <small>(C)</small> Guido Draheim
<br><i> guidod<small>@</small>gmx.de</i>
</p>
<!--mksite:emailfooter:guidod@gmx.de?subject=zzip:-->

<p align="right"><small><small>
   formatted by <a href="http://zziplib.sf.net/mksite">mksite.sh</a>
</p>

<p><b>as xml:</b></p>
<hr><a href="zzip-index.xml">Library</a>
<br>-<a href="64on32.xml"> 64on32 extras</a>
<br>-<a href="future.xml"> Next To Come</a> <br> &nbsp;
</td><td> 

 
<table width="100%"><tr valign="bottom"><td><h2> ZIP File Access &</td><td align="right"><i>  Using Zipped Files Transparently </i></td></tr></table>

<!--border-->


<h3>The Typedef</h3>

<p class="P">
 The typedef <code>ZZIP_FILE</code> can serve as a replacement 
 for a normal file descriptor. As long as it is only used
 for reading a file, the zzlib-user can actually replace
 the posix functions <code>open/read/close</code> 
 by their counterparts from the 
 <a href="zziplib.html">zziplib library</a>:
 <code>zzip_open/zzip_read/zzip_close</code>.
</p>
<p class="P">
 As long as the filename path given to <code>zzip_open</code>
 refers to a real file in the filesystem, it will almost
 directly forward the call to the respective posix <code>open</code>
 call. The returned file descriptor is then stored in
 a member-variable of the <code>ZZIP_FILE</code> structure.
</p>
<p class="P">
 Any subsequent calls to <code>zzip_read</code> will then
 be forwarded to the posix <code>read</code> call on the
 memorized file descriptor. The same about <code>zzip_close</code>
 which will call the posix <code>close</code> function and then
 <code>free</code> the <code>ZZIP_FILE</code> structure.
</p>
<p class="P">
 The real benefit of the 
 <a href="zziplib.html">zziplib library</a>
 comes about when the filename argument does actually refer
 to a file that is zipped in a zip-archive. It happens that
 even both a real file and a zipped file can live under the
 same pathname given to the <code>zzip_open</code> call,
 whereas the real file is used in preference.
</p>


<h3>Zipped File</h3>

<p class="P">
 Suppose you have subdirectory called '<tt>test/</tt>'. In
 this directory is just one file, called '<tt>README</tt>'.
 Calling the <code>zzip_open</code> function with an
 argument of '<i>optional-path/</i> <tt>test/README</tt>',
 then it will open that file for subsequent reading with
 <code>zzip_read</code>. In this case the real (<i>stat'able</i>)
 file is opened.
</p>
<p class="P">
 Now you can go to the '<tt>test/</tt>' directory and zip up
 the files in there by calling 
 <nobr><tt>`zip ../test.zip *`</tt></nobr>.
 After this, you can delete the '<tt>test/</tt>' directory and
 the call to <code>zzip_open</code> will still succeed.
 The reason is that the part of the path saying 
 '<tt>test/README</tt>' will be replaced by sth. like 
 '<tt>test.zip:README</tt>' - that is the real file '<tt>test.zip</tt>'
 is opened and searched for a contained file '<tt>README</tt>'.
</p>
<p class="P">
 Calling <code>zzip_read</code> on the zipped '<tt>README</tt>' file
 will return the very same data as if it is a real file in a
 real directory. If the zipped file is compressed it will be 
 decompressed on the fly.
</p>


<h3>Zip Directory</h3>

<p class="P">
 The same applies to the use of <code>opendir/readdir/closedir</code>
 which can safely be replaced with their counterparts from the
 <a href="zziplib.html">zziplib library</a> - again their prototype
 follows the scheme of the original calls, just prepend <tt>zzip_</tt>
 to the function calls and <tt>ZZIP_</tt> to the struct-typedefs.
</p>
<p class="P">
 To call <code>zzip_opendir</code> on a real directory will then
 return a <code>ZZIP_DIR</code> whose member-variable 
 <code>realdir</code> points to the actual <code>DIR</code>-structure
 returned by the underlying posix <code>opendir</code>-call.
</p>
<p class="P">
 If a real directory '<tt>test</tt>' does not exist, then the
 <code>zzip_opendir</code> will try to open a file '<tt>test.zip</tt>'
 with a call to <code>zzip_dir_open</code>.
 Subsequent calls to <code>zzip_readdir</code> will then return
 information as being obtained from the central archive directory
 of the zip-file.
</p>


<h3>Differences</h3>

<p class="P">
 There are no differences between the posix calls and their counterparts
 from the      <a href="zziplib.html">zziplib library</a> - well, just
 as long as the zip-file contains just the plain files from a directory.
</p>
<p class="P">
 If the zip-file contains directory entries you may be prompted with
 some awkward behaviour, since in zip-file a directory happens to be
 just an empty file. Note that the posix function <code>open</code>
 may also open a directory for reading - it will only return 
 <code>EISDIR</code> if the <code>open</code> mode-argument included
 write-access.
</p>
<p class="P">
 What the current of version of the 
 <a href="zziplib.html">zziplib library</a>
 can definitly not do: calling zzip_opendir on a directory zippend
 <em>inside</em> a zip-file.
</p>
<p class="P">
 To prevent the enrollment of directories into the zip-archive, you
 can use the <tt>-D</tt> option of the <tt>zip</tt> program. That
 is in any <tt>Makefile</tt> you may want to use
 <nobr><tt>`cd $(dir) &amp;&amp; zip -D ../$(dir).zip *`</tt></nobr>.
</p> 


<h3>Advantages</h3>

<p class="P">
 Distribution of a set of files is much easier if it just means
 to wrap up a group of files into a zip-archive - and copy that
 zip-archive to the respective destination directory.
 Even more the files can be compressed and unlike a <tt>tar.gz</tt>
 archive there is no need to decompress the archive in temporary
 location before accessing a member-file.
</p>
<p class="P">
 On the other hand, there is no chance to scatter files around
 on the disk like it could easily happen with a set of gzip'ed
 man-pages in a single `<tt>man</tt>`-directory. The reader
 application does not specifically need to know that the file
 is compressed, so that reading a script like 
 `<tt>share/guile/x.x.x/ice-9/popen.scm</tt>` is done by simple
 calls to <code>zzip_read</code> which works on zip-file named
 `<tt>share/guile/x.x.x/ice-9.zip</tt>`.
</p>
<p class="P">
 A version mismatch between different files in a group is now
 obvious: either the opened file belongs to the distribution
 archive, or otherwise in resides in a real directory <em>just
 next to the zip-archive that contains the original</em>.
</p>


<h3>Issues</h3>

<p class="P">
 The  <a href="zziplib.html">zziplib library</a> does not
 use any code piece from the <code>zip</code> programs, neither
 <em>pkzip</em> nor <em>infozip</em>, so there is no license
 issue here. The decompression is done by using the free
 <a href="http://www.gzip.org/zlib">zlib library</a> which has no special
 issues with respect to licensing. 
 The  rights to the <a href="zziplib.html">zziplib library</a> 
 are reserved to the copyright holders, there is a public
 license that puts most the sources themselves under 
 <a href="COPYING.LIB">the GNU Lesser General Public License</a>,
 so that the use of a shared library instance of the
 <a href="zziplib.html">zziplib library</a>
 has no restrictions of interest to application programmers.
 For more details and hints about static linking, check
 the <a href="copying.html">COPYING</a> information.
</p>
<p class="P">
 The only issue you have with the
 <a href="zziplib.html">zziplib library</a>
 is the fact that you can only <em>read</em> the contained files.
 Writing/Compression is not implemented. Even more, a compressed
 file is not seekable at the moment although I hope that someone
 will stand up to implement that functionality someday.
</p>


<hr><table border="0" width="100%"><tr><td>
<a href="mailto:guidod@gmx.de?subject=zzip:">guidod@gmx.de</a>
</td><td align="right">
1. June 2000</td></tr></table>
</td></tr></table></body></html>
